extends ../layout
include ../mixins/_text_editor

block content

    .l-margin-start
    if url.endsWith('/characters')
        .l-divider
            .c-divider__left
                h1 Editar Personajes
            .c-divider__right
    else
        a.l-divider(href=`/users/${user.username}/characters`)
            .c-divider__left
                if url.endsWith('/newcharacter')
                    h1 &#10525; Personaje Nuevo
                else
                    h1 &#10525; Editar Personajes: #{character.name}
            .c-divider__right

    if url.endsWith('/characters')
        .l-main-content
                .l-search
                    form.c-search(action='')
                        .c-search__input
                            label(for='name') Nombre
                            input(type='text' name='name' id='name' placeholder='Buscar personaje por nombre' disabled)
                        .c-search__input
                            label(for='relationship') Relacion
                            input(type='text' name='relationship' id='relationship' placeholder='Buscar personaje por relacion' disabled)
                        .c-search__input
                            label(for='place') Lugar
                            input(type='text' name='place' id='place' placeholder='Buscar personaje por lugar' disabled)
                        .c-search__input
                            label(for='race') Raza
                            input(type='text' name='race' id='race' placeholder='Buscar personaje por raza' disabled)
                        .c-search__input
                            button.c-button--large.m-background-lightgray(type='' disabled) Buscar

                .l-margin--2
                .l-ability-points-grid.grid--3
                    div
                    a.c-button--large.m-clickable(href=`/users/${username}/characters/newcharacter`) Nuevo Personaje
                    div
                
                .l-margin--3
                .l-cards--4
                    each character in characters
                        a.c-card(href=`/users/${username}/characters/edit/${character._id}`)
                            .c-card__header
                                .c-card__header-left
                                    h2 #{character.name}
                                .c-card__header-right
                            if character.image != '' && character.image != undefined
                                img.c-card__image(src=`http://res.cloudinary.com/duezou4td/image/upload/${character.image}.png` alt=`${character.name}'s Image`)
                            else
                                img.c-card__image(src=tmpImg)

    else if url.endsWith('/newcharacter')
        form.c-editchar-form(action='' method='post' enctype='multipart/form-data')
            .l-main-content.l-editchar-grid
                .l-text-wrap
                    label.l-margin-right--1(for='image') Subir imagen:
                    input(type='file' name='image')
                    .c-basic-info
                        h3 Resumen
                        .c-editchar-form__input
                            label(for='title') Título:
                            input#titleinput(type='text' name='title' placeholder='Mago de Orzov')
                        .c-editchar-form__input
                            label(for='affiliation') Afiliación:
                            input#affiliationinput(type='text' name='affiliation' placeholder='Convento de Magos')
                        .c-editchar-form__input
                            label(for='place') Lugar de Origen o donde fué conocido:
                            input(type='text' name='place' placeholder='Orzov')
                        .c-editchar-form__input
                            label(for='age') Edad:
                            input(type='number' name='age' min='0' placeholder='--')
                        .c-editchar-form__input
                            label(for='race') Raza:
                            input(type='text' name='race' placeholder='Enano')
                        .c-editchar-form__input
                            label(for='class') Clase:
                            input(type='text' name='class' placeholder='Wizard/Mago')
                        .c-editchar-form__input
                            label(for='size') Tamaño:
                            input(type='text' name='size' placeholder='Small/Chico')
                    .c-basic-info
                        h3 Apariencia
                        .c-editchar-form__input
                            textarea(name='appearance' rows='5' placeholder='Enano sin ropa, tiene una barba metálica larga que le cubre el cuerpo.')

                div
                    input#charnameinput(type='text' name='name' placeholder='Nombre del Personaje' required)

                    .c-editchar-form__input
                        +textEditor('editor', '', 'Escribe el resumen o la historia de este personaje aquí.', 'summary')
                
            .l-main-content.l-clearleft       
                .l-margin--2
                button.c-button--large.m-clickable(type='submit') Crear Personaje
    
    else
        form.c-editchar-form(action='' method='post' enctype='multipart/form-data')
            .l-main-content.l-editchar-grid
                .l-text-wrap
                    if character.image != '' && character.image != undefined
                        img.l-text-wrap__image(src=`http://res.cloudinary.com/duezou4td/image/upload/${character.image}.png` alt=`${character.name}'s Image`)
                        .l-margin--2
                            label.l-margin-right--1(for='image') Cambiar imagen:
                            input(type='file' name='image')
                    else
                        label.l-margin-right--1(for='image') Subir imagen:
                        input(type='file' name='image')
                    .c-basic-info
                        h3 Resumen
                        .c-editchar-form__input
                            label(for='title') Título:
                            input#titleinput(type='text' name='title' placeholder='Mago de Orzov' value=(character.title || null))
                        .c-editchar-form__input
                            label(for='affiliation') Afiliación:
                            input(type='text' name='affiliation' placeholder='Convento de Magos' value=(character.affiliation || null))
                        .c-editchar-form__input
                            label(for='place') Lugar de Origen o donde fué conocido:
                            input(type='text' name='place' placeholder='Orzov' value=(character.place || null))
                        .c-editchar-form__input
                            label(for='age') Edad:
                            input(type='number' name='age' min='0' placeholder='--' value=(character.age || null))
                        .c-editchar-form__input
                            label(for='race') Raza:
                            input(type='text' name='race' placeholder='Enano' value=(character.race || null))
                        .c-editchar-form__input
                            label(for='class') Clase:
                            input(type='text' name='class' placeholder='Wizard/Mago' value=(character.class || null))
                        .c-editchar-form__input
                            label(for='size') Tamaño:
                            input(type='text' name='size' placeholder='Small/Chico' value=(character.size || null))
                    .c-basic-info
                        h3 Apariencia
                        .c-editchar-form__input
                            textarea(name='appearance' rows='5' placeholder='Enano sin ropa, tiene una barba metálica larga que le cubre el cuerpo.')=(character.appearance || null)

                div
                    input#charnameinput(type='text' name='name' placeholder='Onorim' value=(character.name) required)

                    .c-editchar-form__input
                        +textEditor('editor', character.summary, 'Escribe el resumen o la historia de este personaje aquí.', 'summary')
            
            .l-main-content.l-clearleft       
                .l-margin--2
                button.c-button--large.m-clickable.l-margin-right--1(type='submit' name='deletecharacter' value='false') Guardar Cambios
                button.c-button--large.m-clickable.m-background-red(type='submit' name='deletecharacter' value='true') Borrar Personaje