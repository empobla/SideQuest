extends ../layout
include ../mixins/_text_editor

block content
    
    .l-margin-start
    if url.endsWith('/story')
        .l-divider
            .c-divider__left
                h1 Editar Historia
            .c-divider__right
    else
        a.l-divider(href=`/users/${user.username}/story`)
            .c-divider__left
                if url.endsWith('/newstory')
                    h1 &#10525; Nueva Historia
                else
                    h1 &#10525; Editar Historia: #{story.name}
            .c-divider__right
    
    if url.endsWith('/story')
        .l-main-content
            .l-search
                form.c-search(action='')
                    .c-search__input
                        label(for='name') Nombre de la sesión
                        input(type='text' name='name' id='name' placeholder='Buscar sesión por nombre' disabled)
                    .c-search__input--button
                        button.c-button--large.m-background-lightgray(type='' disabled) Buscar
        
            .l-margin--2
            .l-ability-points-grid.grid--3
                div
                a.c-button--large.m-clickable(href=`/users/${username}/story/newstory`) Nueva Historia
                div
        
        .l-margin--3
        .l-main-content
            table.l-spells
                each story in stories
                    tr.c-spell
                        td.m-align-left
                            a.m-color-black(href=`/users/${username}/story/edit/${story._id}`) #{story.name}

    else if url.endsWith('/newstory')
        .l-main-content
            form.c-edithero-form(action='' method='post')
                .c-edithero-form__input
                    label(for='name') *Nombre de la Sesión:
                    input(type='text' name='name' id='name' placeholder='Sesión 1' required)
                .c-edithero-form__input.c-edithero-form__input--stack
                    label(for='summary') Resumen:
                    +textEditor('editor', '', 'Escribe el resumen principal de la sesión aquí.', 'summary')
                .l-margin--2
                button.c-button--large.m-clickable(type='submit') Crear Nueva Historia
    
    else
        .l-main-content
            form.c-edithero-form(action='' method='post')
                .c-edithero-form__input
                    label(for='name') *Nombre de la Sesión:
                    input(type='text' name='name' id='name' placeholder='Sesión 1' value=story.name required)
                .c-edithero-form__input.c-edithero-form__input--stack
                    label(for='summary') Resumen:
                    +textEditor('editor', story.summary || '', 'Escribe el resumen principal de la sesión aquí.', 'summary')
                .l-margin--2
                button.c-button--large.m-clickable.l-margin-right--1(type='submit' name='deletestory' value='false') Guardar Cambios
                button.c-button--large.m-clickable.m-background-red(type='submit' name='deletestory' value='true') Borrar Historia