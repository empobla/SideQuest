extends ../layout
include ../mixins/_text_editor

block content

    .l-margin-start
    if url.endsWith('/maps')
        .l-divider
            .c-divider__left
                h1 Editar Mapas
            .c-divider__right
    else
        a.l-divider(href=`/users/${user.username}/maps`)
            .c-divider__left
                if url.endsWith('/newmap')
                    h1 &#10525; Mapa Nuevo
                else if url.endsWith('/search')
                    h1 &#10525; Editar Mapas: Búsqueda
                else
                    h1 &#10525; Editar Mapa: #{map.name}
            .c-divider__right
    
    if url.endsWith('/maps') || url.endsWith('/search')
        .l-main-content
                .l-search
                    form.c-search(action=`/users/${username}/maps/search` method='post')
                        .c-search__input
                            label(for='name') Nombre
                            input(type='text' name='name' id='name' placeholder='Buscar mapa por nombre')
                        .c-search__input
                            button.c-button--large.m-clickable(type='submit') Buscar

                .l-margin--2
                .l-ability-points-grid.grid--3
                    div
                    a.c-button--large.m-clickable(href=`/users/${username}/maps/newmap`) Nuevo Mapa
                    div
                
                .l-margin--3
                .l-cards--4
                    each map in maps
                        a.c-card(href=`/users/${username}/maps/edit/${map._id}`)
                            .c-card__header
                                .c-card__header-left
                                    h2 #{map.name}
                                .c-card__header-right
                            img.c-card__image(src=`http://res.cloudinary.com/duezou4td/image/upload/${map.image}.png` alt=`${map.name} Image`)
    
    else if url.endsWith('/newmap')
        .l-main-content
            form.c-edithero-form(action='' method='post' enctype='multipart/form-data')
                .c-edithero-form__input.c-edithero-form__input--stack
                    label(for='name') *Nombre del Mapa:
                    input(type='text' name='name' placeholder='Imedu: Encuentro con Oyzzyrnaith' required)

                    label(for='image') *Imagen del Mapa:
                    input(type='file' name='image' required)

                    label(for='description') Descripción del Mapa (opcional):
                    +textEditor('editor', '', 'Escribe la descripción del mapa o los eventos que ocurrieron en este mapa aquí', 'description')

                button.c-button--large.m-clickable(type='submit') Crear Mapa
    
    else
        .l-main-content
            form.c-edithero-form(action='' method='post' enctype='multipart/form-data')
                .c-edithero-form__input.c-edithero-form__input--stack
                    label(for='name') *Nombre del Mapa:
                    input(type='text' name='name' placeholder='Imedu: Encuentro con Oyzzyrnaith' value=map.name required)
                    
                    label(for='image') *Imagen del Mapa:
                    input(type='file' name='image')
                    .c-mapimage
                        img(src=`http://res.cloudinary.com/duezou4td/image/upload/${map.image}.png` alt=`${map.name} Image`)
                    .l-margin--1

                    label(for='description') Descripción del Mapa (opcional):
                    +textEditor('editor', map.description, 'Escribe la descripción del mapa o los eventos que ocurrieron en este mapa aquí', 'description')

                button.c-button--large.m-clickable.l-margin-right--1(type='submit' name='deletemap' value='false') Guardar Cambios
                button.c-button--large.m-background-red.m-clickable(type='submit' name='deletemap' value='true') Borrar Mapa
